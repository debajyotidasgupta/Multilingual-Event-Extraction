140     23      0.5
32      100
LSTM
loading data......
Training data size:340
Development data size:79
preparing vocabulary......
getting pos tags......
Training started......
train_size
340
11
Some weights of the model checkpoint at bert-base-multilingual-cased were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.decoder.weight', 'cls.seq_relationship.bias', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with anotherarchitecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/home/ubuntu/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py:65: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.5 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
Parameters size:12068461
weight factor:1.0
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 1e-05
)
Epoch:1
340
  0%|                                                                                                | 0/11 [00:00<?, ?it/s]/home/ubuntu/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py:692: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters(). (Triggered internally at  ../aten/src/ATen/native/cudnn/RNN.cpp:925.)
  self.dropout, self.training, self.bidirectional, self.batch_first)
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:58<00:00,  5.29s/it]
Training loss:23.449213894930754
Training time:0:00:58.221026

Dev Results

  0%|                                                                                                 | 0/3 [00:00<?, ?it/s]joint_ee_bert_train_18_10.py:902: UserWarning: masked_fill_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (Triggered internally at  /pytorch/aten/src/ATen/native/cuda/Indexing.cu:963.)
  attn_weights.data.masked_fill_(src_mask.data, -float('inf'))
joint_ee_bert_train_18_10.py:1104: UserWarning: masked_fill_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (Triggered internally at  /pytorch/aten/src/ATen/native/cuda/Indexing.cu:963.)
  trig_s.data.masked_fill_(src_mask.data, -float('inf'))
joint_ee_bert_train_18_10.py:1108: UserWarning: masked_fill_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (Triggered internally at  /pytorch/aten/src/ATen/native/cuda/Indexing.cu:963.)
  trig_e.data.masked_fill_(src_mask.data, -float('inf'))
joint_ee_bert_train_18_10.py:1112: UserWarning: masked_fill_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (Triggered internally at  /pytorch/aten/src/ATen/native/cuda/Indexing.cu:963.)
  ent_s.data.masked_fill_(src_mask.data, -float('inf'))
joint_ee_bert_train_18_10.py:1116: UserWarning: masked_fill_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (Triggered internally at  /pytorch/aten/src/ATen/native/cuda/Indexing.cu:963.)
  src_mask.data, -float('inf'))  # [bs,src_seq_len]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.57s/it]
Prediction time:0:00:04.706060
67
39      113     0
F1:0.0
model saved......



Epoch:2
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:37<00:00,  3.38s/it]
Training loss:22.101836984807793
Training time:0:00:37.158175

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.58s/it]
Prediction time:0:00:04.734820
609
60      113     0
F1:0.0
model saved......



Epoch:3
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:37<00:00,  3.38s/it]
Training loss:21.472749710083008
Training time:0:00:37.209693

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.58s/it]
Prediction time:0:00:04.753101
809
91      113     2
F1:0.019607838193484523
model saved......



Epoch:4
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.29s/it]
Training loss:20.734872471202504
Training time:0:00:36.197441

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.51s/it]
Prediction time:0:00:04.529026
403
73      113     0
F1:0.0



Epoch:5
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:35<00:00,  3.26s/it]
Training loss:20.25331791964444
Training time:0:00:35.819040

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.58s/it]
Prediction time:0:00:04.746572
448
99      113     2
F1:0.018867919548328123



Epoch:6
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.32s/it]
Training loss:19.843218543312766
Training time:0:00:36.546291

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.56s/it]
Prediction time:0:00:04.675182
589
96      113     6
F1:0.05741626297017054
model saved......



Epoch:7
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:35<00:00,  3.26s/it]
Training loss:19.92482514814897
Training time:0:00:35.880718

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.56s/it]
Prediction time:0:00:04.692159
495
79      113     7
F1:0.07291666181586405
model saved......



Epoch:8
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.30s/it]
Training loss:19.477330467917703
Training time:0:00:36.246949

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.61s/it]
Prediction time:0:00:04.822730
585
89      113     5
F1:0.04950494556072983



Epoch:9
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:37<00:00,  3.38s/it]
Training loss:19.26607790860263
Training time:0:00:37.189259

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.57s/it]
Prediction time:0:00:04.704202
577
79      113     7
F1:0.07291666181586405
model saved......



Epoch:10
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.35s/it]
Training loss:19.067897623235528
Training time:0:00:36.875473

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.57s/it]
Prediction time:0:00:04.706945
572
78      113     7
F1:0.07329842447959244
model saved......



Epoch:11
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.34s/it]
Training loss:18.908952539617363
Training time:0:00:36.739603

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.57s/it]
Prediction time:0:00:04.709127
552
83      113     2
F1:0.02040815838036352



Epoch:12
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:37<00:00,  3.41s/it]
Training loss:18.613618503917348
Training time:0:00:37.457700

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.62s/it]
Prediction time:0:00:04.873722
835
79      113     7
F1:0.07291666181586405



Epoch:13
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.29s/it]
Training loss:18.345381303267047
Training time:0:00:36.218957

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.55s/it]
Prediction time:0:00:04.646017
762
87      113     7
F1:0.06999999507750036



Epoch:14
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.33s/it]
Training loss:18.108486609025434
Training time:0:00:36.606836

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.56s/it]
Prediction time:0:00:04.693761
718
144     113     4
F1:0.031128399739588062



Epoch:15
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.36s/it]
Training loss:18.194115378639914
Training time:0:00:36.986366

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.52s/it]
Prediction time:0:00:04.553365
659
85      113     6
F1:0.06060605569992898



Epoch:16
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.35s/it]
Training loss:17.990718321366742
Training time:0:00:36.889060

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.53s/it]
Prediction time:0:00:04.582425
813
80      113     9
F1:0.09326424384117721
model saved......



Epoch:17
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.31s/it]
Training loss:17.782963752746582
Training time:0:00:36.417294

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.57s/it]
Prediction time:0:00:04.709419
1165
116     113     9
F1:0.07860261508132982



Epoch:18
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.31s/it]
Training loss:17.93545506217263
Training time:0:00:36.451786

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.57s/it]
Prediction time:0:00:04.701281
752
83      113     9
F1:0.09183672980164541



Epoch:19
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:37<00:00,  3.37s/it]
Training loss:17.707641774957832
Training time:0:00:37.019429

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.56s/it]
Prediction time:0:00:04.689771
664
123     113     9
F1:0.07627118144319193



Epoch:20
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:37<00:00,  3.38s/it]
Training loss:17.683632070367988
Training time:0:00:37.137437

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.52s/it]
Prediction time:0:00:04.565577
751
102     113     7
F1:0.06511627407679867



Epoch:21
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.34s/it]
Training loss:17.472186348655008
Training time:0:00:36.724610

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.53s/it]
Prediction time:0:00:04.587145
853
131     113     9
F1:0.07377048682444269



Epoch:22
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.36s/it]
Training loss:17.260618903420188
Training time:0:00:36.979512

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.55s/it]
Prediction time:0:00:04.637336
899
105     113     9
F1:0.08256880233860817



Epoch:23
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:35<00:00,  3.24s/it]
Training loss:17.339864990927957
Training time:0:00:35.694439

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.52s/it]
Prediction time:0:00:04.559345
946
132     113     13
F1:0.10612244400099982
model saved......



Epoch:24
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:37<00:00,  3.37s/it]
Training loss:17.227496840737082
Training time:0:00:37.025188

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.56s/it]
Prediction time:0:00:04.684507
794
116     113     10
F1:0.08733623953471552



Epoch:25
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.29s/it]
Training loss:17.15274255925959
Training time:0:00:36.213045

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.61s/it]
Prediction time:0:00:04.837517
829
98      113     12
F1:0.11374407084387166
model saved......



Epoch:26
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.33s/it]
Training loss:16.95360027660023
Training time:0:00:36.642362

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.58s/it]
Prediction time:0:00:04.751237
949
122     113     13
F1:0.11063829287025827



Epoch:27
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.32s/it]
Training loss:16.801767175847832
Training time:0:00:36.575076

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.62s/it]
Prediction time:0:00:04.845550
914
110     113     11
F1:0.09865470351223658



Epoch:28
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.28s/it]
Training loss:16.928669062527742
Training time:0:00:36.094690

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.56s/it]
Prediction time:0:00:04.688499
809
130     113     13
F1:0.10699587978932774



Epoch:29
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.34s/it]
Training loss:16.699168812144887
Training time:0:00:36.782241

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.58s/it]
Prediction time:0:00:04.747555
751
94      113     12
F1:0.11594202401643003
model saved......



Epoch:30
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.33s/it]
Training loss:16.67322939092463
Training time:0:00:36.643414

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.60s/it]
Prediction time:0:00:04.811730
814
142     113     13
F1:0.10196077937039624



Epoch:31
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:37<00:00,  3.37s/it]
Training loss:16.67095236344771
Training time:0:00:37.075544

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.56s/it]
Prediction time:0:00:04.677635
825
115     113     11
F1:0.0964912230620963



Epoch:32
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.30s/it]
Training loss:16.471947149796918
Training time:0:00:36.329692

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.57s/it]
Prediction time:0:00:04.700987
811
137     113     11
F1:0.08799999503904028



Epoch:33
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.35s/it]
Training loss:16.261816111477938
Training time:0:00:36.824496

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.47s/it]
Prediction time:0:00:04.420617
823
133     113     13
F1:0.10569105193502569



Epoch:34
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:36<00:00,  3.34s/it]
Training loss:16.258947892622515
Training time:0:00:36.689073

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.57s/it]
Prediction time:0:00:04.710688
898
119     113     12
F1:0.1034482708564955



Epoch:35
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:37<00:00,  3.37s/it]
Training loss:16.11371577869762
Training time:0:00:37.019441

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.62s/it]
Prediction time:0:00:04.875152
910
122     113     13
F1:0.11063829287025827



Epoch:36
340
100%|███████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:37<00:00,  3.38s/it]
Training loss:16.065223953940652
Training time:0:00:37.135050

Dev Results

100%|█████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.52s/it]
Prediction time:0:00:04.547544
863
147     113     13
F1:0.0999999950778109



*******
Best Epoch:29
Best Epoch Seed:1052